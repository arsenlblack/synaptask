"use strict";(self.webpackChunksynaptask_docs=self.webpackChunksynaptask_docs||[]).push([[280],{3069:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"api/ws/node_add","title":"node:add","description":"Create a new node via WebSocket event. Equivalent to POST /api/node in REST.","source":"@site/docs/api/ws/node_add.md","sourceDirName":"api/ws","slug":"/api/ws/node_add","permalink":"/api/ws/node_add","draft":false,"unlisted":false,"editUrl":"https://github.com/arsenlblack/synaptask/edit/main/docs/api/ws/node_add.md","tags":[],"version":"current","lastUpdatedBy":"admin","lastUpdatedAt":1758388283000,"frontMatter":{"title":"node:add","slug":"/api/ws/node_add"},"sidebar":"tutorialSidebar","previous":{"title":"graph:get","permalink":"/guides/share-access"},"next":{"title":"link:add","permalink":"/api/ws/link_add"}}');var i=d(4848),r=d(8453);const t={title:"node:add",slug:"/api/ws/node_add"},o=void 0,a={},c=[{value:"Visibility &amp; Permissions",id:"visibility--permissions",level:2},{value:"Socket.IO Event",id:"socketio-event",level:2},{value:"Request Payload",id:"request-payload",level:3},{value:"Success Response (<code>node:added</code>)",id:"success-response-nodeadded",level:3},{value:"Error Response (<code>node:add:error</code>)",id:"error-response-nodeadderror",level:3},{value:"Examples",id:"examples",level:2},{value:"JavaScript",id:"javascript",level:3},{value:"Python (socketio-client)",id:"python-socketio-client",level:3}];function l(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Create a new node via WebSocket event. Equivalent to ",(0,i.jsx)(n.code,{children:"POST /api/node"})," in REST."]}),"\n",(0,i.jsx)(n.h2,{id:"visibility--permissions",children:"Visibility & Permissions"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Requires ",(0,i.jsx)(n.strong,{children:"authenticated user"})," (",(0,i.jsx)(n.code,{children:"socket_auth_required"}),")."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If a ",(0,i.jsx)(n.code,{children:"target"})," (parent node) is provided:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["User must have ",(0,i.jsx)(n.strong,{children:"editor"})," access on the parent."]}),"\n",(0,i.jsxs)(n.li,{children:["New node ",(0,i.jsx)(n.strong,{children:"inherits"})," the owner and ACL from the parent node."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"viewer"})," or ",(0,i.jsx)(n.code,{children:"no access"})," \u2192 ",(0,i.jsx)(n.code,{children:"forbidden"})," error."]}),"\n"]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["You can create a ",(0,i.jsx)(n.strong,{children:"stand-alone node"})," (without specifying ",(0,i.jsx)(n.code,{children:"target"}),")",(0,i.jsx)(n.br,{}),"\n","and later attach it to a read-only branch using ",(0,i.jsx)(n.a,{href:"./link_add",children:(0,i.jsx)(n.code,{children:"POST /api/link"})}),"."]}),(0,i.jsx)(n.p,{children:"In this case:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"source"'})," \u2192 your new node\u2019s ",(0,i.jsx)(n.code,{children:"id"}),","]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"target"'})," \u2192 the read-only node\u2019s ",(0,i.jsx)(n.code,{children:"id"}),","]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:'"type": 1'})," \u2192 secondary link (keeps your graph consistent without changing branch ACLs)."]}),"\n"]}),(0,i.jsxs)(n.p,{children:["This way, ",(0,i.jsx)(n.strong,{children:"you remain the owner"})," of the new node, while still preserving graph consistency and task dependencies."]})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If no ",(0,i.jsx)(n.code,{children:"target"})," is provided, node is created ",(0,i.jsx)(n.strong,{children:"standalone"})," under the caller\u2019s ownership."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["A primary link (type=0) is created if the parent is ",(0,i.jsx)(n.code,{children:"dependant=true"}),", otherwise a secondary link (type=1)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"History batch records node creation, the link (if any) and all side effects like blocking parent (if any)."}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"socketio-event",children:"Socket.IO Event"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Client \u2192 Server:"})," ",(0,i.jsx)(n.code,{children:"node:add"}),"\n",(0,i.jsx)(n.strong,{children:"Server \u2192 Client (success):"})," ",(0,i.jsx)(n.code,{children:"node:added"}),"\n",(0,i.jsx)(n.strong,{children:"Server \u2192 Client (error):"})," ",(0,i.jsx)(n.code,{children:"node:add:error"})]}),"\n",(0,i.jsx)(n.h3,{id:"request-payload",children:"Request Payload"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "target": "<uuid>",          // optional parent node id\n  "props": {\n    "title": "string",\n    "description": "string",\n    "status": 0,\n    "dueDate": "2025-09-13T10:00:00Z",\n    "tags": "csv",\n    "priority": 5,\n    "dependant": true,\n    "volume": 5,\n    "asignee": ["user1", "user2"],\n    "pinned": false,\n    "collapsed": false\n  }\n}\n'})}),"\n",(0,i.jsxs)(n.h3,{id:"success-response-nodeadded",children:["Success Response (",(0,i.jsx)(n.code,{children:"node:added"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "ok": true,\n  "diff": {\n    "nodes": [\n      {\n        "id": "uuid",\n        "title": "string",\n        "description": "string",\n        "status": 0,\n        "dueDate": "2025-09-13T10:00:00Z",\n        "tags": "csv",\n        "priority": 5,\n        "dependant": true,\n        "volume": 5,\n        "asignee": [],\n        "pinned": false,\n        "collapsed": false,\n        "createdTime": "2025-09-13T10:00:00Z",\n        "lastEditedTime": "2025-09-13T10:00:00Z",\n        "version": 0\n      },\n      { // blocket target\n        "id": "uuid",\n        "status": 2,\n      }\n    ],\n    "links": [\n      {\n        "id": "uuid",\n        "source": "nodeId",\n        "target": "nodeId",\n        "type": 0,\n        "wasBlocker": false,\n        "version": 0\n      }\n    ]\n  }\n}\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"The first object in nodes is the newly created node with all its properties.\nExisting nodes that were modified as a side effect (e.g., a parent being blocked) are also included, but only with the updated fields."})}),"\n",(0,i.jsxs)(n.h3,{id:"error-response-nodeadderror",children:["Error Response (",(0,i.jsx)(n.code,{children:"node:add:error"}),")"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "ok": false,\n  "error": "bad_request" | "forbidden" | "internal" | "not_found" | "rate_limited",\n  "message": "<optional human-readable>"\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h3,{id:"javascript",children:"JavaScript"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:'socket.emit("node:add", {\n  target: "123e4567-e89b-12d3-a456-426614174000",\n  props: {\n    title: "New task",\n    priority: 5,\n    dependant: true\n  }\n});\n\nsocket.on("node:added", (data) => {\n  console.log("Node created:", data);\n});\n\nsocket.on("node:add:error", (err) => {\n  console.error("Node add failed:", err);\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"python-socketio-client",children:"Python (socketio-client)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import socketio\n\nsio = socketio.Client()\n\n@sio.event\ndef connect():\n    print("Connected")\n\n@sio.on("node:added")\ndef on_node_added(data):\n    print("Node created:", data)\n\n@sio.on("node:add:error")\ndef on_node_error(err):\n    print("Node add failed:", err)\n\nsio.connect("https://synaptask.space", headers={"Authorization": "Bearer <API_TOKEN>"})\nsio.emit("node:add", {\n    "props": {"title": "Write WS docs", "priority": 3}\n})\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,d)=>{d.d(n,{R:()=>t,x:()=>o});var s=d(6540);const i={},r=s.createContext(i);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);